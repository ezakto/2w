!function(a){"use strict";function k(){a.$2w.initialize()}function l(a,b){var c,d,e,f,j,k;if(a===b)return!0;if(j=typeof a,k=typeof b,j!==k||j!==g.func&&j!==g.object&&k!==g.func&&k!==g.object&&a!==b)return!1;if(j=i.call(a),k=i.call(b),j!==k)return!1;if(j===h.array){if((d=a.length)!==b.length)return!1;for(c=0;d>c;c++)if(!l(a[c],b[c]))return!1}else if(j===h.object){d=0;for(f in a)if(d++,!l(a[f],b[f]))return!1;e=0;for(f in b)e++;if(d!==e)return!1}return!0}function m(a){var b,c,d,e,f;if(e=typeof a,e!==g.object)return a;if(e=i.call(a),e===h.array)for(f=[],b=0,d=a.length;d>b;b++)f.push(m(a[b]));else if(e===h.object){f={};for(c in a)f[c]=m(a[c])}return f}var b=a.document,c={},d=[],e=!0,f={controllerAttr:"data-controller",formModelAttr:"data-model",expressionStart:"{{",expressionEnd:"}}",interval:50},g={object:"object",array:"object",func:"function"},h={object:"[object Object]",array:"[object Array]",func:"[object Function]"},i=Object.prototype.toString,j=function(){};j.prototype.initialize=function(){var a=this,c=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;f._expre=new RegExp(f.expressionStart.replace(c,"\\$&")+"(.*?)"+f.expressionEnd.replace(c,"\\$&")),a.traverse(b.documentElement),d.forEach(function(b){var c=b.shift();c.apply(null,b.map(function(b){return a._controller(b).$scope}))}),a.digest()},j.prototype.traverse=function(a){var d,e,g,b=this;if(1===a.nodeType&&a.hasAttribute(f.controllerAttr)&&(g=a.getAttribute(f.controllerAttr),c[g]=b._attachController(a,g)),a.hasChildNodes())for(d=0,e=a.childNodes.length;e>d;d++)b.traverse(a.childNodes[d])},j.prototype._controller=function(a,b){var e;return"undefined"==typeof b?c[a]||(c[a]={_scope:{},$scope:{},dic:{},org:{},tmp:{}}):(e=a.split(/\s+/),e.unshift(b),d.push(e),j)},j.prototype.controller=function(a,b){return"undefined"==typeof b?this._controller(a).$scope:this._controller(a,b)},j.prototype._attachController=function(a,b,c){var e,h,j,d=this;if(typeof b!==g.object&&(b=d._controller(b)),c&&(b.force=!0),1===a.nodeType&&a.hasAttributes())for(e=0,h=a.attributes.length;h>e;e++)d._attachController(a.attributes[e],b);if(a.hasChildNodes())for(e=0,h=a.childNodes.length;h>e;e++)d._attachController(a.childNodes[e],b);else 1!==a.nodeType||"INPUT"!==a.nodeName&&"TEXTAREA"!==a.nodeName?2===a.nodeType?(j=a.value.search(f._expre),-1!==j&&(a.$2w_id=Math.random(),b.org[a.$2w_id]=a.value,b.dic[a.$2w_id]=a)):3===a.nodeType&&(j=a.nodeValue.search(f._expre),-1!==j&&(a.$2w_id=Math.random(),b.org[a.$2w_id]=a.textContent,b.dic[a.$2w_id]=a)):a.hasAttribute(f.formModelAttr)&&(a.$2w_id=Math.random(),b.dic[a.$2w_id]=a,d.addInputListener(a,b));return b},j.prototype.attachController=function(a,b){return this._attachController(a,b,!0).$scope},j.prototype.render=function(a){var d,e,c=this;for(e in a.dic)if(d=a.dic[e],1!==d.nodeType||"INPUT"!==d.nodeName&&"TEXTAREA"!==d.nodeName){if(2===d.nodeType||3===d.nodeType)for(a.tmp[d.$2w_id]||(a.tmp[d.$2w_id]=a.org[d.$2w_id]);-1!==a.tmp[d.$2w_id].search(f._expre);)a.tmp[d.$2w_id]=a.tmp[d.$2w_id].replace(f._expre,function(b,d){return c.expression.call(a,d)})}else{if(d===b.activeElement)continue;d.value=c.expression.call(a,d.getAttribute(f.formModelAttr))}for(e in a.dic)d=a.dic[e],2===d.nodeType?d.value=a.tmp[d.$2w_id]:3===d.nodeType&&(d.textContent=a.tmp[d.$2w_id]);return a.tmp={},a},j.prototype.digest=function(){var d,g,a=this;if(e){e=!1;for(d in c)g=c[d],(g.force||!l(g.$scope,g._scope))&&(a.render(g),g._scope=m(g.$scope),g.force=!1);setTimeout(function(){a.digest()},f.interval),e=!0}},j.prototype.expression=function(a,b){var c,d;try{d=new Function("with (this.$scope) { return ("+a+"); }"),c=d.call(b||this),(null===c||"undefined"==typeof c)&&(c="")}catch(e){c=""}return c},j.prototype.addInputListener=function(a,b){var c=function(){b.$scope[this.getAttribute(f.formModelAttr)]=this.value};a.addEventListener("keypress",c,!1),a.addEventListener("keyup",c,!1)},j.prototype.fn=j.prototype,j.prototype.config=f,a.$2w=new j,b.addEventListener&&b.addEventListener("DOMContentLoaded",k,!1),b.attachEvent&&b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&k()}),!Array.prototype.forEach&&(Array.prototype.forEach=function(a,b){var c,d;for(c=0,d=this.length;d>c;c++)a.call(b,this[c],c,this)})}(window);